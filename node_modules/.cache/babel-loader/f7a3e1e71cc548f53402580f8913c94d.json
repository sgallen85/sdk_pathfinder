{"ast":null,"code":"import _slicedToArray from\"/Users/sallen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Users/sallen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sallen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/sallen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/sallen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/sallen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/sallen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/sallen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{GetSDK}from'../mp/GetSDK';import'./App.scss';import Frame from'./Frame';import Menu from'./ui/Menu';import MenuButton from'./ui/MenuButton';import Pathfinder from'./Pathfinder';import Translator from'./Translator';import{initComponents}from'./sdk-components';import{pathRendererType}from'./sdk-components/PathRenderer';import{cameraControllerType}from'./sdk-components/CameraController';import{sweepIdToPoint}from'./utils';import{sweepAliases}from'./sweepAliases';import ControlsOverlay from'./ui/overlay/ControlsOverlay';import FlyModeButton from'./ui/overlay/FlyModeButton';import IconButton from'./reusables/icon-button/IconButton';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var defaultUrlParams={m:'6gR9HhhJJTc',applicationKey:'x67cy2qhc1h8f1nkmh1ax3i6c',title:'0',qs:'1',hr:'0',brand:'0',help:'0',play:'1'};/**\n * This is the top level class for the app. It handles API key, model ID, and url stuff,\n * and holds references to objects/modules/components for object composition.\n * Do non-initializing SDK and UI stuff in other components/files.\n */var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);// the url source for the sdk\n// the node for the PathRenderer component\n// human-readable alias for sweeps, if available\n// the node for the CameraController component\n// CameraConroller component\nfunction App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.src=void 0;_this.urlLang=null;_this.sdk=void 0;_this.pathNode=void 0;_this.pathfinder=void 0;_this.sweepAlias=void 0;_this.flyNode=void 0;_this.camCon=void 0;_this.onOptionSelect=function(id){if(id===_this.state.selectedSweepId){_this.clearSelection();}else{_this.setState({selectedSweepId:id});}};_this.clearSelection=function(){if(_this.pathNode)_this.pathNode.stop();_this.setState({path:undefined,selectedSweepId:undefined});};_this.toggleFlyMode=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var flyModeEnabled;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:flyModeEnabled=_this.state.flyModeEnabled;_this.setState({flyModeEnabled:!flyModeEnabled,flyU:0},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!flyModeEnabled){_context.next=5;break;}_context.next=3;return _this.exitFly();case 3:_context.next=7;break;case 5:_context.next=7;return _this.initFly();case 7:case\"end\":return _context.stop();}}},_callee);})));case 2:case\"end\":return _context2.stop();}}},_callee2);}));_this.initFly=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _assertThisInitialize,sdk,path,cam,_this$camCon$getPoseA,position,rotation;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_assertThisInitialize=_assertThisInitialized(_this),sdk=_assertThisInitialize.sdk;path=_this.state.path;if(!(sdk&&path)){_context3.next=17;break;}if(_this.flyNode)_this.flyNode.stop();_context3.next=6;return sdk.Scene.createNode();case 6:_this.flyNode=_context3.sent;_this.camCon=_this.flyNode.addComponent(cameraControllerType,{changeUCallback:function changeUCallback(u){return _this.setState({flyU:u});}});cam=_this.flyNode.addComponent('mp.camera',{enabled:true});_this.camCon.bind('curve',path,'curve');cam.bind('camera',_this.camCon,'camera');_this.flyNode.start();// orient camera to start of flythrough\n_this$camCon$getPoseA=_this.camCon.getPoseAt(0),position=_this$camCon$getPoseA.position,rotation=_this$camCon$getPoseA.rotation;_context3.next=15;return sdk.Mode.moveTo(sdk.Mode.Mode.DOLLHOUSE,{position:position,rotation:{x:rotation.x*180/Math.PI,y:rotation.y*180/Math.PI}});case 15:// start flythough\n_this.setState({flyU:0});_this.playFly();case 17:case\"end\":return _context3.stop();}}},_callee3);}));_this.exitFly=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _assertThisInitialize2,sdk,flyNode;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_assertThisInitialize2=_assertThisInitialized(_this),sdk=_assertThisInitialize2.sdk,flyNode=_assertThisInitialize2.flyNode;if(flyNode)flyNode.stop();if(sdk)sdk.Mode.moveTo(sdk.Mode.Mode.INSIDE);_this.setState({flyModePlaying:false});case 4:case\"end\":return _context4.stop();}}},_callee4);}));_this.playFly=function(){if(_this.camCon)_this.camCon.inputs.enabled=true;_this.setState({flyModePlaying:true});};_this.pauseFly=function(){if(_this.camCon)_this.camCon.inputs.enabled=false;_this.setState({flyModePlaying:false});};_this.setFlyU=function(u){if(_this.camCon)_this.camCon.setU(u);};_this.toggleMenu=function(){_this.setState({menuEnabled:!_this.state.menuEnabled});};var queryString=_this.handleUrlParams();_this.src=\"\".concat(process.env.PUBLIC_URL,\"/bundle/showcase.html?\").concat(queryString);_this.state={lang:_this.urlLang?_this.urlLang:'en',sweepData:[],menuEnabled:true,flyModeEnabled:false,flyU:0,flyModePlaying:false};return _this;}/**\n   * Parses the current url params and combines them with the default params, updating when necessary.\n   * @returns url param query string (without `?`), ready to be pasted directly into the url\n   */_createClass(App,[{key:\"handleUrlParams\",value:function handleUrlParams(){var params=new URLSearchParams(window.location.search);this.urlLang=params.get('lang');for(var _i=0,_Object$entries=Object.entries(defaultUrlParams);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),k=_Object$entries$_i[0],v=_Object$entries$_i[1];if(!params.has(k)){params.append(k,''+v);// convert v to string\n}}return params.toString();}// --- React methods ---------------------------------------------------------\n},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var _this2=this;var lang;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return GetSDK('showcase',defaultUrlParams.applicationKey);case 2:this.sdk=_context6.sent;_context6.next=5;return initComponents(this.sdk);case 5:_context6.next=7;return this.sdk.Model.getData().then(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(data){var _this2$sdk,mattertags;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!(data.sid==='GycExKiYVFp')){_context5.next=5;break;}mattertags=[];mattertags.push({label:\"Revitalizing the Great Hall\",description:\"Within the buildingâ€™s Great Hall, new vestibule spaces were created to \"+\"connect the main circulation corridor to new restrooms. Elevator lobbies and \"+\"office suite entrances were treated as extensions of the original McKim design, \"+\"with matching marble flooring and wall base, and stained oak millwork-encased \"+\"openings.\",anchorPosition:{x:16.55,y:1.28-1.5,z:6.69},stemVector:{x:0,y:1,z:0}});_context5.next=5;return(_this2$sdk=_this2.sdk)===null||_this2$sdk===void 0?void 0:_this2$sdk.Mattertag.add(mattertags);case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x){return _ref5.apply(this,arguments);};}());case 7:// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nlang=this.state.lang;_context6.next=10;return this.sdk.Model.getData().then(function(data){var sweepData=data.sweeps;_this2.pathfinder=new Pathfinder(sweepData);_this2.setState({sweepData:sweepData});_this2.sweepAlias=sweepAliases[data.sid];});case 10:this.sdk.Sweep.data.subscribe({onCollectionUpdated:function onCollectionUpdated(collection){_this2.setState({sweepMap:collection});}});this.sdk.Floor.data.subscribe({onCollectionUpdated:function onCollectionUpdated(collection){_this2.setState({floorMap:collection});}});this.sdk.Sweep.current.subscribe(function(currentSweep){if(currentSweep.sid){console.log(currentSweep.sid,currentSweep.position);_this2.setState({currSweepId:currentSweep.sid});}});// translate all mattertags, if not English\nif(lang!=='en')this.translateMattertags(lang);case 14:case\"end\":return _context6.stop();}}},_callee6,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"componentDidUpdate\",value:function componentDidUpdate(_prevProps,prevState){var _this$state=this.state,currSweepId=_this$state.currSweepId,selectedSweepId=_this$state.selectedSweepId;// only update path if sweep state changes\n(currSweepId!==prevState.currSweepId||selectedSweepId!==prevState.selectedSweepId)&&this.handlePath();}// --- SDK methods -----------------------------------------------------------\n},{key:\"handlePath\",value:function(){var _handlePath=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var _this$state2,currSweepId,selectedSweepId,sweepMap,sdk,pathfinder,path;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_this$state2=this.state,currSweepId=_this$state2.currSweepId,selectedSweepId=_this$state2.selectedSweepId,sweepMap=_this$state2.sweepMap;sdk=this.sdk,pathfinder=this.pathfinder;if(!(sdk&&sweepMap&&currSweepId&&selectedSweepId&&pathfinder)){_context7.next=14;break;}_context7.next=5;return pathfinder.findShortestPath(currSweepId,selectedSweepId);case 5:path=_context7.sent;if(path){_context7.next=8;break;}return _context7.abrupt(\"return\");case 8:if(this.pathNode)this.pathNode.stop();_context7.next=11;return sdk.Scene.createNode();case 11:this.pathNode=_context7.sent;this.setState({path:path.length>1?this.pathNode.addComponent(pathRendererType,{path:path.map(function(id){return sweepIdToPoint(id,sweepMap);}),opacity:0.7,radius:0.12,stepMultiplier:10}):undefined});this.pathNode.start();case 14:case\"end\":return _context7.stop();}}},_callee7,this);}));function handlePath(){return _handlePath.apply(this,arguments);}return handlePath;}()},{key:\"translateMattertags\",value:function(){var _translateMattertags=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(lang){var sdk,Trans,mattertagData,_loop,i;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:sdk=this.sdk;if(!(sdk&&lang)){_context8.next=9;break;}Trans=new Translator(lang);_context8.next=5;return sdk.Mattertag.getData();case 5:mattertagData=_context8.sent;_loop=function _loop(i){var _mattertagData$i=mattertagData[i],sid=_mattertagData$i.sid,label=_mattertagData$i.label,description=_mattertagData$i.description,media=_mattertagData$i.media;var callBack=function callBack(newTexts){var _newTexts=_slicedToArray(newTexts,2),newLabel=_newTexts[0],newDescription=_newTexts[1];sdk.Mattertag.editBillboard(sid,{label:newLabel,description:newDescription,media:media});};Trans.translate([label,description],callBack);};for(i=0;i<mattertagData.length;i++){_loop(i);}Trans.checkUsage();case 9:case\"end\":return _context8.stop();}}},_callee8,this);}));function translateMattertags(_x2){return _translateMattertags.apply(this,arguments);}return translateMattertags;}()},{key:\"changeLang\",value:function(){var _changeLang=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(lang){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:this.setState({lang:lang});this.translateMattertags(lang);case 2:case\"end\":return _context9.stop();}}},_callee9,this);}));function changeLang(_x3){return _changeLang.apply(this,arguments);}return changeLang;}()// --- Render ----------------------------------------------------------------\n},{key:\"render\",value:function render(){var _this3=this;var _this$state3=this.state,lang=_this$state3.lang,currSweepId=_this$state3.currSweepId,selectedSweepId=_this$state3.selectedSweepId,sweepData=_this$state3.sweepData,menuEnabled=_this$state3.menuEnabled,flyModeEnabled=_this$state3.flyModeEnabled,flyU=_this$state3.flyU,path=_this$state3.path,flyModePlaying=_this$state3.flyModePlaying,floorMap=_this$state3.floorMap;return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"frame-container\",children:[/*#__PURE__*/_jsx(Frame,{src:this.src,disableClicks:flyModeEnabled}),/*#__PURE__*/_jsx(\"div\",{id:\"overlay-container\",children:path&&(flyModeEnabled?/*#__PURE__*/_jsx(ControlsOverlay,{playing:flyModePlaying,onPlay:this.playFly,onPause:this.pauseFly,onExit:this.toggleFlyMode,setU:this.setFlyU,u:flyU}):/*#__PURE__*/_jsxs(\"div\",{className:\"nofly-button-container\",children:[/*#__PURE__*/_jsx(FlyModeButton,{lang:lang,onClick:this.toggleFlyMode}),/*#__PURE__*/_jsx(IconButton,{onClick:this.clearSelection,icon:\"close\",classes:['clear-button']})]}))})]}),!menuEnabled&&/*#__PURE__*/_jsx(MenuButton,{onClick:this.toggleMenu}),menuEnabled&&/*#__PURE__*/_jsx(Menu,{lang:lang,currSweepId:currSweepId,selectedSweepId:selectedSweepId,sweepData:sweepData,sweepAlias:this.sweepAlias,floorMap:floorMap,onChange:this.onOptionSelect,onClose:this.toggleMenu,onChangeLang:function onChangeLang(e){return _this3.changeLang(e.target.value);}})]});}}]);return App;}(Component);export{App as default};","map":{"version":3,"sources":["/Users/sallen/Documents/GitHub/sdk_wayfinder/src/app/App.tsx"],"names":["React","Component","GetSDK","Frame","Menu","MenuButton","Pathfinder","Translator","initComponents","pathRendererType","cameraControllerType","sweepIdToPoint","sweepAliases","ControlsOverlay","FlyModeButton","IconButton","defaultUrlParams","m","applicationKey","title","qs","hr","brand","help","play","App","props","src","urlLang","sdk","pathNode","pathfinder","sweepAlias","flyNode","camCon","onOptionSelect","id","state","selectedSweepId","clearSelection","setState","stop","path","undefined","toggleFlyMode","flyModeEnabled","flyU","exitFly","initFly","Scene","createNode","addComponent","changeUCallback","u","cam","enabled","bind","start","getPoseAt","position","rotation","Mode","moveTo","DOLLHOUSE","x","Math","PI","y","playFly","INSIDE","flyModePlaying","inputs","pauseFly","setFlyU","setU","toggleMenu","menuEnabled","queryString","handleUrlParams","process","env","PUBLIC_URL","lang","sweepData","params","URLSearchParams","window","location","search","get","Object","entries","k","v","has","append","toString","Model","getData","then","data","sid","mattertags","push","label","description","anchorPosition","z","stemVector","Mattertag","add","sweeps","Sweep","subscribe","onCollectionUpdated","collection","sweepMap","Floor","floorMap","current","currentSweep","console","log","currSweepId","translateMattertags","_prevProps","prevState","handlePath","findShortestPath","length","map","opacity","radius","stepMultiplier","Trans","mattertagData","i","media","callBack","newTexts","newLabel","newDescription","editBillboard","translate","checkUsage","e","changeLang","target","value"],"mappings":"6hCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,MAAT,KAAuB,cAAvB,CAEA,MAAO,YAAP,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,CACA,MAAOC,CAAAA,IAAP,KAAiB,WAAjB,CACA,MAAOC,CAAAA,UAAP,KAAuB,iBAAvB,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CACA,OAASC,cAAT,KAA+B,kBAA/B,CACA,OAASC,gBAAT,KAAiC,+BAAjC,CACA,OAASC,oBAAT,KAAqC,mCAArC,CACA,OAASC,cAAT,KAA+B,SAA/B,CACA,OAAqBC,YAArB,KAAyC,gBAAzC,CACA,MAAOC,CAAAA,eAAP,KAA4B,8BAA5B,CACA,MAAOC,CAAAA,aAAP,KAA0B,4BAA1B,CACA,MAAOC,CAAAA,UAAP,KAAuB,oCAAvB,C,wFAoBA,GAAMC,CAAAA,gBAAqB,CAAG,CAC5BC,CAAC,CAAE,aADyB,CAE5BC,cAAc,CAAE,2BAFY,CAG5BC,KAAK,CAAE,GAHqB,CAI5BC,EAAE,CAAE,GAJwB,CAK5BC,EAAE,CAAE,GALwB,CAM5BC,KAAK,CAAE,GANqB,CAO5BC,IAAI,CAAE,GAPsB,CAQ5BC,IAAI,CAAE,GARsB,CAA9B,CAWA;AACA;AACA;AACA;AACA,G,GACqBC,CAAAA,G,0FAEE;AAIE;AAGU;AAEX;AACD;AAErB,aAAYC,KAAZ,CAAwB,qCACtB,uBAAMA,KAAN,EADsB,MAZhBC,GAYgB,cAXhBC,OAWgB,CAXS,IAWT,OAVhBC,GAUgB,cARhBC,QAQgB,cAPhBC,UAOgB,cALhBC,UAKgB,cAHhBC,OAGgB,cAFhBC,MAEgB,cA8GhBC,cA9GgB,CA8GC,SAACC,EAAD,CAAgB,CACvC,GAAIA,EAAE,GAAK,MAAKC,KAAL,CAAWC,eAAtB,CAAuC,CACrC,MAAKC,cAAL,GACD,CAFD,IAEO,CACL,MAAKC,QAAL,CAAc,CACZF,eAAe,CAAEF,EADL,CAAd,EAGD,CACF,CAtHuB,OA6IhBG,cA7IgB,CA6IC,UAAM,CAC7B,GAAI,MAAKT,QAAT,CAAmB,MAAKA,QAAL,CAAcW,IAAd,GACnB,MAAKD,QAAL,CAAc,CACZE,IAAI,CAAEC,SADM,CAEZL,eAAe,CAAEK,SAFL,CAAd,EAID,CAnJuB,OAqJhBC,aArJgB,sEAqJA,2JACdC,cADc,CACK,MAAKR,KADV,CACdQ,cADc,CAEtB,MAAKL,QAAL,CAAc,CACZK,cAAc,CAAE,CAACA,cADL,CAEZC,IAAI,CAAE,CAFM,CAAd,sEAGG,uIACGD,cADH,+CAEO,OAAKE,OAAL,EAFP,2DAIO,OAAKC,OAAL,EAJP,uDAHH,IAFsB,wDArJA,SAmKhBA,OAnKgB,sEAmKN,2QACRnB,GADQ,uBACRA,GADQ,CAERa,IAFQ,CAEC,MAAKL,KAFN,CAERK,IAFQ,MAIZb,GAAG,EAAIa,IAJK,4BAKd,GAAI,MAAKT,OAAT,CAAkB,MAAKA,OAAL,CAAaQ,IAAb,GALJ,uBAMOZ,CAAAA,GAAG,CAACoB,KAAJ,CAAUC,UAAV,EANP,QAMd,MAAKjB,OANS,gBAOd,MAAKC,MAAL,CAAc,MAAKD,OAAL,CAAakB,YAAb,CAA0BzC,oBAA1B,CAAgD,CAC5D0C,eAAe,CAAE,yBAACC,CAAD,QAAe,OAAKb,QAAL,CAAc,CAACM,IAAI,CAAEO,CAAP,CAAd,CAAf,EAD2C,CAAhD,CAAd,CAGMC,GAVQ,CAUF,MAAKrB,OAAL,CAAakB,YAAb,CAA0B,WAA1B,CAAuC,CACjDI,OAAO,CAAE,IADwC,CAAvC,CAVE,CAad,MAAKrB,MAAL,CAAYsB,IAAZ,CAAiB,OAAjB,CAA0Bd,IAA1B,CAAgC,OAAhC,EACAY,GAAG,CAACE,IAAJ,CAAS,QAAT,CAAmB,MAAKtB,MAAxB,CAAgC,QAAhC,EACA,MAAKD,OAAL,CAAawB,KAAb,GAEA;AAjBc,sBAkBiB,MAAKvB,MAAL,CAAYwB,SAAZ,CAAsB,CAAtB,CAlBjB,CAkBNC,QAlBM,uBAkBNA,QAlBM,CAkBIC,QAlBJ,uBAkBIA,QAlBJ,yBAmBR/B,CAAAA,GAAG,CAACgC,IAAJ,CAASC,MAAT,CAAgBjC,GAAG,CAACgC,IAAJ,CAASA,IAAT,CAAcE,SAA9B,CAAyC,CAC7CJ,QAAQ,CAARA,QAD6C,CAE7CC,QAAQ,CAAE,CAACI,CAAC,CAAEJ,QAAQ,CAACI,CAAT,CAAW,GAAX,CAAeC,IAAI,CAACC,EAAxB,CAA4BC,CAAC,CAAEP,QAAQ,CAACO,CAAT,CAAW,GAAX,CAAeF,IAAI,CAACC,EAAnD,CAFmC,CAAzC,CAnBQ,SAwBd;AACA,MAAK1B,QAAL,CAAc,CAACM,IAAI,CAAE,CAAP,CAAd,EACA,MAAKsB,OAAL,GA1Bc,yDAnKM,SAiMhBrB,OAjMgB,sEAiMN,oOACRlB,GADQ,wBACRA,GADQ,CACHI,OADG,wBACHA,OADG,CAEhB,GAAIA,OAAJ,CAAaA,OAAO,CAACQ,IAAR,GACb,GAAIZ,GAAJ,CAASA,GAAG,CAACgC,IAAJ,CAASC,MAAT,CAAgBjC,GAAG,CAACgC,IAAJ,CAASA,IAAT,CAAcQ,MAA9B,EACT,MAAK7B,QAAL,CAAc,CAAE8B,cAAc,CAAE,KAAlB,CAAd,EAJgB,wDAjMM,SAwMhBF,OAxMgB,CAwMN,UAAM,CACtB,GAAI,MAAKlC,MAAT,CAAiB,MAAKA,MAAL,CAAYqC,MAAZ,CAAmBhB,OAAnB,CAA6B,IAA7B,CACjB,MAAKf,QAAL,CAAc,CAAE8B,cAAc,CAAE,IAAlB,CAAd,EACD,CA3MuB,OA4MhBE,QA5MgB,CA4ML,UAAM,CACvB,GAAI,MAAKtC,MAAT,CAAiB,MAAKA,MAAL,CAAYqC,MAAZ,CAAmBhB,OAAnB,CAA6B,KAA7B,CACjB,MAAKf,QAAL,CAAc,CAAE8B,cAAc,CAAE,KAAlB,CAAd,EACD,CA/MuB,OAgNhBG,OAhNgB,CAgNN,SAACpB,CAAD,CAAe,CAAC,GAAI,MAAKnB,MAAT,CAAiB,MAAKA,MAAL,CAAYwC,IAAZ,CAAiBrB,CAAjB,EAAoB,CAhN/C,OAkNhBsB,UAlNgB,CAkNH,UAAM,CACzB,MAAKnC,QAAL,CAAc,CACZoC,WAAW,CAAE,CAAC,MAAKvC,KAAL,CAAWuC,WADb,CAAd,EAGD,CAtNuB,CAEtB,GAAMC,CAAAA,WAAW,CAAG,MAAKC,eAAL,EAApB,CACA,MAAKnD,GAAL,WAAcoD,OAAO,CAACC,GAAR,CAAYC,UAA1B,kCAA6DJ,WAA7D,EAEA,MAAKxC,KAAL,CAAa,CACX6C,IAAI,CAAE,MAAKtD,OAAL,CAAe,MAAKA,OAApB,CAA8B,IADzB,CAEXuD,SAAS,CAAE,EAFA,CAGXP,WAAW,CAAE,IAHF,CAIX/B,cAAc,CAAE,KAJL,CAKXC,IAAI,CAAE,CALK,CAMXwB,cAAc,CAAE,KANL,CAAb,CALsB,aAavB,CAED;AACF;AACA;AACA,K,+CACE,0BAAkC,CAChC,GAAMc,CAAAA,MAAM,CAAG,GAAIC,CAAAA,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAf,CACA,KAAK5D,OAAL,CAAewD,MAAM,CAACK,GAAP,CAAW,MAAX,CAAf,CACA,6BAAqBC,MAAM,CAACC,OAAP,CAAe3E,gBAAf,CAArB,gCAAuD,8DAA3C4E,CAA2C,uBAAxCC,CAAwC,uBACrD,GAAI,CAACT,MAAM,CAACU,GAAP,CAAWF,CAAX,CAAL,CAAoB,CAClBR,MAAM,CAACW,MAAP,CAAcH,CAAd,CAAiB,GAAGC,CAApB,EAAwB;AACzB,CACF,CACD,MAAOT,CAAAA,MAAM,CAACY,QAAP,EAAP,CACD,CAED;2HAEA,wLAEmB9F,CAAAA,MAAM,CAAC,UAAD,CAAac,gBAAgB,CAACE,cAA9B,CAFzB,QAEE,KAAKW,GAFP,uCAGQrB,CAAAA,cAAc,CAAC,KAAKqB,GAAN,CAHtB,+BAQQ,MAAKA,GAAL,CAASoE,KAAT,CAAeC,OAAf,GAAyBC,IAAzB,2FAA+B,kBAAOC,IAAP,qJAC/BA,IAAI,CAACC,GAAL,GAAa,aADkB,2BAE3BC,UAF2B,CAEd,EAFc,CAGjCA,UAAU,CAACC,IAAX,CACE,CACEC,KAAK,CAAE,6BADT,CAEEC,WAAW,CAAE,0EACX,+EADW,CAEX,kFAFW,CAGX,gFAHW,CAIX,WANJ,CAOEC,cAAc,CAAE,CAAC1C,CAAC,CAAE,KAAJ,CAAWG,CAAC,CAAE,KAAK,GAAnB,CAAwBwC,CAAC,CAAE,IAA3B,CAPlB,CAQEC,UAAU,CAAE,CAAE5C,CAAC,CAAE,CAAL,CAAQG,CAAC,CAAE,CAAX,CAAcwC,CAAC,CAAE,CAAjB,CARd,CADF,EAHiC,mCAe3B,MAAI,CAAC9E,GAfsB,qCAe3B,WAAUgF,SAAV,CAAoBC,GAApB,CAAwBR,UAAxB,CAf2B,yDAA/B,gEARR,QA0BE;AAEQpB,IA5BV,CA4BmB,KAAK7C,KA5BxB,CA4BU6C,IA5BV,yBA8BQ,MAAKrD,GAAL,CAASoE,KAAT,CAAeC,OAAf,GAAyBC,IAAzB,CAA+B,SAACC,IAAD,CAAU,CAC7C,GAAMjB,CAAAA,SAAS,CAAGiB,IAAI,CAACW,MAAvB,CACA,MAAI,CAAChF,UAAL,CAAkB,GAAIzB,CAAAA,UAAJ,CAAe6E,SAAf,CAAlB,CACA,MAAI,CAAC3C,QAAL,CAAc,CACZ2C,SAAS,CAAEA,SADC,CAAd,EAGA,MAAI,CAACnD,UAAL,CAAkBpB,YAAY,CAACwF,IAAI,CAACC,GAAN,CAA9B,CACD,CAPK,CA9BR,SAuCE,KAAKxE,GAAL,CAASmF,KAAT,CAAeZ,IAAf,CAAoBa,SAApB,CAA8B,CAC5BC,mBAAmB,CAAE,6BAACC,UAAD,CAA6D,CAChF,MAAI,CAAC3E,QAAL,CAAc,CACZ4E,QAAQ,CAAED,UADE,CAAd,EAGD,CAL2B,CAA9B,EAQA,KAAKtF,GAAL,CAASwF,KAAT,CAAejB,IAAf,CAAoBa,SAApB,CAA8B,CAC5BC,mBAAmB,CAAE,6BAACC,UAAD,CAAmD,CACtE,MAAI,CAAC3E,QAAL,CAAc,CACZ8E,QAAQ,CAAEH,UADE,CAAd,EAGD,CAL2B,CAA9B,EAQA,KAAKtF,GAAL,CAASmF,KAAT,CAAeO,OAAf,CAAuBN,SAAvB,CAAiC,SAACO,YAAD,CAAuB,CACtD,GAAIA,YAAY,CAACnB,GAAjB,CAAsB,CACpBoB,OAAO,CAACC,GAAR,CAAYF,YAAY,CAACnB,GAAzB,CAA8BmB,YAAY,CAAC7D,QAA3C,EACA,MAAI,CAACnB,QAAL,CAAc,CAACmF,WAAW,CAAEH,YAAY,CAACnB,GAA3B,CAAd,EACD,CACF,CALD,EAOA;AACA,GAAInB,IAAI,GAAK,IAAb,CACE,KAAK0C,mBAAL,CAAyB1C,IAAzB,EAhEJ,8D,+IAmEA,4BAA0B2C,UAA1B,CAA2CC,SAA3C,CAAgE,iBACrB,KAAKzF,KADgB,CACtDsF,WADsD,aACtDA,WADsD,CACzCrF,eADyC,aACzCA,eADyC,CAG9D;AACA,CAACqF,WAAW,GAAKG,SAAS,CAACH,WAA1B,EACDrF,eAAe,GAAKwF,SAAS,CAACxF,eAD9B,GAEA,KAAKyF,UAAL,EAFA,CAGD,CAED;6GAYA,+NACqD,KAAK1F,KAD1D,CACUsF,WADV,cACUA,WADV,CACuBrF,eADvB,cACuBA,eADvB,CACwC8E,QADxC,cACwCA,QADxC,CAEUvF,GAFV,CAE8B,IAF9B,CAEUA,GAFV,CAEeE,UAFf,CAE8B,IAF9B,CAEeA,UAFf,MAIMF,GAAG,EAAIuF,QAAP,EAAmBO,WAAnB,EAAkCrF,eAAlC,EAAqDP,UAJ3D,mDAKuBA,CAAAA,UAAU,CAACiG,gBAAX,CAA4BL,WAA5B,CAAyCrF,eAAzC,CALvB,QAKUI,IALV,mBAMSA,IANT,mEAOI,GAAI,KAAKZ,QAAT,CAAmB,KAAKA,QAAL,CAAcW,IAAd,GAPvB,wBAQ0BZ,CAAAA,GAAG,CAACoB,KAAJ,CAAUC,UAAV,EAR1B,SAQI,KAAKpB,QART,gBASI,KAAKU,QAAL,CAAe,CACbE,IAAI,CAAEA,IAAI,CAACuF,MAAL,CAAc,CAAd,CAAkB,KAAKnG,QAAL,CAAcqB,YAAd,CAA2B1C,gBAA3B,CAA6C,CACnEiC,IAAI,CAAEA,IAAI,CAACwF,GAAL,CAAS,SAAA9F,EAAE,QAAIzB,CAAAA,cAAc,CAACyB,EAAD,CAAKgF,QAAL,CAAlB,EAAX,CAD6D,CAEnEe,OAAO,CAAE,GAF0D,CAGnEC,MAAM,CAAE,IAH2D,CAInEC,cAAc,CAAE,EAJmD,CAA7C,CAAlB,CAKD1F,SANQ,CAAf,EAQA,KAAKb,QAAL,CAAc2B,KAAd,GAjBJ,8D,uNAgGA,kBAAkCyB,IAAlC,0JACUrD,GADV,CACkB,IADlB,CACUA,GADV,MAGMA,GAAG,EAAIqD,IAHb,2BAIUoD,KAJV,CAIkB,GAAI/H,CAAAA,UAAJ,CAAe2E,IAAf,CAJlB,wBAKgCrD,CAAAA,GAAG,CAACgF,SAAJ,CAAcX,OAAd,EALhC,QAKUqC,aALV,qCAMaC,CANb,uBAOiDD,aAAa,CAACC,CAAD,CAP9D,CAOcnC,GAPd,kBAOcA,GAPd,CAOmBG,KAPnB,kBAOmBA,KAPnB,CAO0BC,WAP1B,kBAO0BA,WAP1B,CAOuCgC,KAPvC,kBAOuCA,KAPvC,CAQM,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,QAAD,CAAwB,8BACHA,QADG,IAC/BC,QAD+B,cACrBC,cADqB,cAEvChH,GAAG,CAACgF,SAAJ,CAAciC,aAAd,CAA4BzC,GAA5B,CAAiC,CAC/BG,KAAK,CAAEoC,QADwB,CAE/BnC,WAAW,CAAEoC,cAFkB,CAG/BJ,KAAK,CAALA,KAH+B,CAAjC,EAKD,CAPD,CAQAH,KAAK,CAACS,SAAN,CAAgB,CAACvC,KAAD,CAAQC,WAAR,CAAhB,CAAsCiC,QAAtC,EAhBN,EAMI,IAASF,CAAT,CAAW,CAAX,CAAcA,CAAC,CAACD,aAAa,CAACN,MAA9B,CAAsCO,CAAC,EAAvC,CAA2C,OAAlCA,CAAkC,EAW1C,CACDF,KAAK,CAACU,UAAN,GAlBJ,6D,mOAsBA,kBAAyB9D,IAAzB,sHACE,KAAK1C,QAAL,CAAc,CAAC0C,IAAI,CAAJA,IAAD,CAAd,EACA,KAAK0C,mBAAL,CAAyB1C,IAAzB,EAFF,6D,2FAKA;sBAEA,iBAAgB,kCAYV,KAAK7C,KAZK,CAEZ6C,IAFY,cAEZA,IAFY,CAGZyC,WAHY,cAGZA,WAHY,CAIZrF,eAJY,cAIZA,eAJY,CAKZ6C,SALY,cAKZA,SALY,CAMZP,WANY,cAMZA,WANY,CAOZ/B,cAPY,cAOZA,cAPY,CAQZC,IARY,cAQZA,IARY,CASZJ,IATY,cASZA,IATY,CAUZ4B,cAVY,cAUZA,cAVY,CAWZgD,QAXY,cAWZA,QAXY,CAcd,mBACE,aAAK,SAAS,CAAC,KAAf,wBACE,aAAK,EAAE,CAAC,iBAAR,wBACE,KAAC,KAAD,EAAO,GAAG,CAAE,KAAK3F,GAAjB,CAAsB,aAAa,CAAEkB,cAArC,EADF,cAEE,YAAK,EAAE,CAAC,mBAAR,UAEIH,IAAI,GACJG,cAAc,cACd,KAAC,eAAD,EACE,OAAO,CAAEyB,cADX,CAEE,MAAM,CAAE,KAAKF,OAFf,CAGE,OAAO,CAAE,KAAKI,QAHhB,CAIE,MAAM,CAAE,KAAK5B,aAJf,CAKE,IAAI,CAAE,KAAK6B,OALb,CAME,CAAC,CAAE3B,IANL,EADc,cAUd,aAAK,SAAS,CAAC,wBAAf,wBACE,KAAC,aAAD,EACE,IAAI,CAAEoC,IADR,CAEE,OAAO,CAAE,KAAKtC,aAFhB,EADF,cAKE,KAAC,UAAD,EAAY,OAAO,CAAE,KAAKL,cAA1B,CAA0C,IAAI,CAAC,OAA/C,CAAuD,OAAO,CAAE,CAAC,cAAD,CAAhE,EALF,GAXI,CAFR,EAFF,GADF,CA0BI,CAACqC,WAAD,eACA,KAAC,UAAD,EAAY,OAAO,CAAE,KAAKD,UAA1B,EA3BJ,CA6BIC,WAAW,eACX,KAAC,IAAD,EACE,IAAI,CAAEM,IADR,CAEE,WAAW,CAAEyC,WAFf,CAGE,eAAe,CAAErF,eAHnB,CAIE,SAAS,CAAE6C,SAJb,CAKE,UAAU,CAAE,KAAKnD,UALnB,CAME,QAAQ,CAAEsF,QANZ,CAOE,QAAQ,CAAE,KAAKnF,cAPjB,CAQE,OAAO,CAAE,KAAKwC,UARhB,CASE,YAAY,CAAE,sBAACsE,CAAD,QAAO,CAAA,MAAI,CAACC,UAAL,CAAgBD,CAAC,CAACE,MAAF,CAASC,KAAzB,CAAP,EAThB,EA9BJ,GADF,CA6CD,C,iBA9T8BnJ,S,SAAZwB,G","sourcesContent":["import React, { Component } from 'react';\nimport { GetSDK } from '../mp/GetSDK';\nimport { Dictionary, MpSdk, Sweep } from '../mp/sdk';\nimport './App.scss';\nimport Frame from './Frame';\nimport Menu from './ui/Menu';\nimport MenuButton from './ui/MenuButton';\nimport Pathfinder from './Pathfinder';\nimport Translator from './Translator';\nimport { initComponents } from './sdk-components';\nimport { pathRendererType } from './sdk-components/PathRenderer';\nimport { cameraControllerType } from './sdk-components/CameraController';\nimport { sweepIdToPoint } from './utils';\nimport { SweepAlias, sweepAliases } from './sweepAliases';\nimport ControlsOverlay from './ui/overlay/ControlsOverlay';\nimport FlyModeButton from './ui/overlay/FlyModeButton';\nimport IconButton from './reusables/icon-button/IconButton';\n\nexport interface Sdk extends MpSdk {\n  Scene?: any;\n}\n\ninterface AppState {\n  lang: string;\n  currSweepId?: string;\n  selectedSweepId?: string;\n  sweepData: Sweep.SweepData[]; // put in state because changes should trigger rerender\n  sweepMap?: Dictionary<MpSdk.Sweep.ObservableSweepData>;\n  path?: any; // put in state so path visibility updates trigger rerender\n  menuEnabled: boolean;\n  flyModeEnabled: boolean;\n  flyU: number; // integer in [0, 1] indicating position in flythrough\n  flyModePlaying: boolean;\n  floorMap?: Dictionary<MpSdk.Floor.FloorData>;\n}\n\nconst defaultUrlParams: any = {\n  m: '6gR9HhhJJTc',\n  applicationKey: 'x67cy2qhc1h8f1nkmh1ax3i6c',\n  title: '0',\n  qs: '1',\n  hr: '0',\n  brand: '0',\n  help: '0',\n  play: '1',\n}\n\n/**\n * This is the top level class for the app. It handles API key, model ID, and url stuff,\n * and holds references to objects/modules/components for object composition.\n * Do non-initializing SDK and UI stuff in other components/files.\n */\nexport default class App extends Component<{}, AppState> {\n\n  private src: string; // the url source for the sdk\n  private urlLang: string | null = null;\n  private sdk?: Sdk;\n\n  private pathNode: any; // the node for the PathRenderer component\n  private pathfinder?: Pathfinder;\n\n  private sweepAlias?: SweepAlias; // human-readable alias for sweeps, if available\n\n  private flyNode: any; // the node for the CameraController component\n  private camCon: any; // CameraConroller component\n\n  constructor(props: any) {\n    super(props);\n    const queryString = this.handleUrlParams();\n    this.src = `${process.env.PUBLIC_URL}/bundle/showcase.html?${queryString}`;\n\n    this.state = {\n      lang: this.urlLang ? this.urlLang : 'en',\n      sweepData: [],\n      menuEnabled: true,\n      flyModeEnabled: false,\n      flyU: 0,\n      flyModePlaying: false,\n    };\n  }\n\n  /**\n   * Parses the current url params and combines them with the default params, updating when necessary.\n   * @returns url param query string (without `?`), ready to be pasted directly into the url\n   */\n  private handleUrlParams(): string {\n    const params = new URLSearchParams(window.location.search);\n    this.urlLang = params.get('lang');\n    for (const [k, v] of Object.entries(defaultUrlParams)) {\n      if (!params.has(k)) {\n        params.append(k, ''+v); // convert v to string\n      }\n    }\n    return params.toString();\n  }\n\n  // --- React methods ---------------------------------------------------------\n\n  public async componentDidMount() {\n    \n    this.sdk = await GetSDK('showcase', defaultUrlParams.applicationKey);\n    await initComponents(this.sdk);\n\n    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    // Add user-generated Mattertags to the default model\n    // In production, this block will be removed\n    await this.sdk.Model.getData().then( async (data) => {\n      if (data.sid === 'GycExKiYVFp') {\n        const mattertags = [];\n        mattertags.push(\n          {\n            label: \"Revitalizing the Great Hall\",\n            description: \"Within the buildingâ€™s Great Hall, new vestibule spaces were created to \"+\n              \"connect the main circulation corridor to new restrooms. Elevator lobbies and \"+\n              \"office suite entrances were treated as extensions of the original McKim design, \"+\n              \"with matching marble flooring and wall base, and stained oak millwork-encased \"+\n              \"openings.\",\n            anchorPosition: {x: 16.55, y: 1.28-1.5, z: 6.69},\n            stemVector: { x: 0, y: 1, z: 0 },\n          }\n        );\n        await this.sdk?.Mattertag.add(mattertags);\n      }\n    });\n    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n    const { lang } = this.state;\n\n    await this.sdk.Model.getData().then( (data) => {\n      const sweepData = data.sweeps;\n      this.pathfinder = new Pathfinder(sweepData);\n      this.setState({\n        sweepData: sweepData,\n      });\n      this.sweepAlias = sweepAliases[data.sid];\n    });\n\n    this.sdk.Sweep.data.subscribe({\n      onCollectionUpdated: (collection: Dictionary<MpSdk.Sweep.ObservableSweepData>) => {\n        this.setState({\n          sweepMap: collection\n        });\n      },\n    });\n\n    this.sdk.Floor.data.subscribe({\n      onCollectionUpdated: (collection: Dictionary<MpSdk.Floor.FloorData>) => {\n        this.setState({\n          floorMap: collection,\n        });\n      }\n    })\n\n    this.sdk.Sweep.current.subscribe((currentSweep: any) => {\n      if (currentSweep.sid) {\n        console.log(currentSweep.sid, currentSweep.position);\n        this.setState({currSweepId: currentSweep.sid,});\n      }\n    });\n\n    // translate all mattertags, if not English\n    if (lang !== 'en')\n      this.translateMattertags(lang);\n  }\n\n  public componentDidUpdate(_prevProps: any, prevState: AppState) {\n    const { currSweepId, selectedSweepId } = this.state;\n\n    // only update path if sweep state changes\n    (currSweepId !== prevState.currSweepId ||\n    selectedSweepId !== prevState.selectedSweepId) &&\n    this.handlePath();\n  }\n\n  // --- SDK methods -----------------------------------------------------------\n\n  private onOptionSelect = (id: string) => {\n    if (id === this.state.selectedSweepId) {\n      this.clearSelection();\n    } else {\n      this.setState({\n        selectedSweepId: id,\n      });\n    }\n  }\n\n  private async handlePath() {\n    const { currSweepId, selectedSweepId, sweepMap } = this.state;\n    const { sdk, pathfinder } = this;\n\n    if (sdk && sweepMap && currSweepId && selectedSweepId && pathfinder) {\n      const path = await pathfinder.findShortestPath(currSweepId, selectedSweepId);\n      if (!path) return;\n      if (this.pathNode) this.pathNode.stop();\n      this.pathNode = await sdk.Scene.createNode();\n      this.setState ({\n        path: path.length > 1 ? this.pathNode.addComponent(pathRendererType, {\n          path: path.map(id => sweepIdToPoint(id, sweepMap)),\n          opacity: 0.7,\n          radius: 0.12,\n          stepMultiplier: 10,\n        }) : undefined,\n      });\n      this.pathNode.start();\n    }\n  }\n\n  private clearSelection = () => {\n    if (this.pathNode) this.pathNode.stop();\n    this.setState({\n      path: undefined,\n      selectedSweepId: undefined,\n    });\n  }\n\n  private toggleFlyMode = async () => {\n    const { flyModeEnabled } = this.state;\n    this.setState({\n      flyModeEnabled: !flyModeEnabled,\n      flyU: 0,\n    }, async () => {\n      if (flyModeEnabled) {\n        await this.exitFly();\n      } else {\n        await this.initFly();\n      }\n    });\n  };\n\n  private initFly = async () => {\n    const { sdk } = this;\n    const { path } = this.state;\n\n    if (sdk && path) {\n      if (this.flyNode) this.flyNode.stop();\n      this.flyNode = await sdk.Scene.createNode();\n      this.camCon = this.flyNode.addComponent(cameraControllerType, {\n        changeUCallback: (u: number) => this.setState({flyU: u}),\n      });\n      const cam = this.flyNode.addComponent('mp.camera', {\n        enabled: true,\n      });\n      this.camCon.bind('curve', path, 'curve');\n      cam.bind('camera', this.camCon, 'camera');\n      this.flyNode.start();\n\n      // orient camera to start of flythrough\n      const { position, rotation } = this.camCon.getPoseAt(0);\n      await sdk.Mode.moveTo(sdk.Mode.Mode.DOLLHOUSE, {\n        position,\n        rotation: {x: rotation.x*180/Math.PI, y: rotation.y*180/Math.PI},\n      });\n\n      // start flythough\n      this.setState({flyU: 0});\n      this.playFly();\n    }\n  };\n\n  private exitFly = async () => {\n    const { sdk, flyNode } = this;\n    if (flyNode) flyNode.stop();\n    if (sdk) sdk.Mode.moveTo(sdk.Mode.Mode.INSIDE);\n    this.setState({ flyModePlaying: false, });\n  };\n\n  private playFly = () => {\n    if (this.camCon) this.camCon.inputs.enabled = true;\n    this.setState({ flyModePlaying: true, });\n  };\n  private pauseFly = () => {\n    if (this.camCon) this.camCon.inputs.enabled = false;\n    this.setState({ flyModePlaying: false, });\n  };\n  private setFlyU = (u: number) => {if (this.camCon) this.camCon.setU(u)};\n\n  private toggleMenu = () => {\n    this.setState({\n      menuEnabled: !this.state.menuEnabled,\n    });\n  }\n\n  private async translateMattertags(lang: string) {\n    const { sdk } = this;\n\n    if (sdk && lang) {\n      const Trans = new Translator(lang);\n      const mattertagData = await sdk.Mattertag.getData();\n      for (let i=0; i<mattertagData.length; i++) {\n        const { sid, label, description, media } = mattertagData[i];\n        const callBack = (newTexts: string[]) => {\n          const [ newLabel, newDescription] = newTexts;\n          sdk.Mattertag.editBillboard(sid, {\n            label: newLabel, \n            description: newDescription, \n            media,\n          });\n        };\n        Trans.translate([label, description], callBack);\n      }\n      Trans.checkUsage();\n    }\n  }\n\n  private async changeLang(lang: string) {\n    this.setState({lang});\n    this.translateMattertags(lang);\n  }\n\n  // --- Render ----------------------------------------------------------------\n\n  public render() {\n    const {\n      lang,\n      currSweepId,\n      selectedSweepId,\n      sweepData,\n      menuEnabled,\n      flyModeEnabled,\n      flyU,\n      path,\n      flyModePlaying,\n      floorMap,\n    } = this.state;\n\n    return (\n      <div className='app'>\n        <div id='frame-container'>\n          <Frame src={this.src} disableClicks={flyModeEnabled} />\n          <div id='overlay-container'>\n            {/* Put all showcase overlay components here */}\n            { path && (\n              flyModeEnabled ?\n              <ControlsOverlay\n                playing={flyModePlaying}\n                onPlay={this.playFly}\n                onPause={this.pauseFly}\n                onExit={this.toggleFlyMode}\n                setU={this.setFlyU}\n                u={flyU}\n              /> \n              :\n              <div className='nofly-button-container'>\n                <FlyModeButton\n                  lang={lang}\n                  onClick={this.toggleFlyMode} \n                />\n                <IconButton onClick={this.clearSelection} icon='close' classes={['clear-button']} />\n            </div>\n            )}\n          </div>\n        </div>\n        { !menuEnabled &&\n          <MenuButton onClick={this.toggleMenu} />\n        }\n        { menuEnabled &&\n          <Menu\n            lang={lang}\n            currSweepId={currSweepId}\n            selectedSweepId={selectedSweepId}\n            sweepData={sweepData}\n            sweepAlias={this.sweepAlias}\n            floorMap={floorMap}\n            onChange={this.onOptionSelect}\n            onClose={this.toggleMenu}\n            onChangeLang={(e) => this.changeLang(e.target.value)}\n          />\n        }\n        </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}